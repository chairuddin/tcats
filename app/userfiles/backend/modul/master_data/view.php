<?phpif($action=="add" OR $action=="edit"){/*KATEGORI*/$option_jenis_tamu=array();$option_jenis_tamu['']="Pilih jenis tamu";$q=$mysql->query("SELECT id,judul FROM master_jenis_tamu WHERE id_cabang=$id_cabang ORDER BY judul ");if($q and $mysql->num_rows($q)>0) {	while($d_kategori=$mysql->fetch_assoc($q)) {		$option_jenis_tamu[$d_kategori['id']]=$d_kategori['judul'];	}}/*END KATEGORI*/if($action=='edit') {	$q=$mysql->query("	SELECT 		id,		no_consultan,		nama_consultan,		tanggal_invoice,		nomor_invoice,		tanggal_dispatch,		kurir,		nomor_waybill,		awb,		kode_pos,		sales_amount,		debt,		jenis_kiriman,		jml_koli,		kg,		cek,		address,		phone,		city,		kecamatan,		nama_penerima,		status_delivery,		tanggal_di_kirim,		tanggal_di_terima,		date_report,		price_perkg,		lead_time,		real_time,		remarks,		status,		point_code	FROM		data_sla WHERE id=$id AND id_cabang=$id_cabang	");	$d=$mysql->assoc($q);	foreach($d as $field => $value) {		$_POST[$field]=$_POST[$field]==''?$value:$_POST[$field];	}	} $do_action=backendurl("$modul/".($action=="add"?"save":"update"));$label_action=$action=="add"?"Tambah":"Edit";$form_nama=$form->element_Textbox("No Consultan	","no_consultan");$form_nama_consultan=$form->element_Textbox("Nama Consultan","nama_consultan");$form_tanggal_invoice=$form->element_Textbox("Tanggal Invoice","tanggal_invoice");$form_nomor_invoice=$form->element_Textbox("Nomor Invoice","nomor_invoice");$form_tanggal_dispatch=$form->element_Textbox("Tanggal Dispatch","tanggal_dispatch");$form_kurir=$form->element_Textbox("Kurir","kurir");$form_nomor_waybill=$form->element_Textbox("Nomor Waybill","nomor_waybill");$form_awb=$form->element_Textbox("Awb","awb");$form_kode_pos=$form->element_Textbox("Kode Pos","kode_pos");$form_sales_amount=$form->element_Textbox("Sales Amount","sales_amount");$form_debt=$form->element_Textbox("Debt","debt");$form_jenis_kiriman=$form->element_Textbox("Jenis Kiriman","jenis_kiriman");$form_jml_koli=$form->element_Textbox("Jml Koli","jml_koli");$form_kg=$form->element_Textbox("KG","kg");$form_cek=$form->element_Textbox("Cek","cek");$form_address=$form->element_Textbox("Address","address");$form_phone=$form->element_Textbox("Phone","phone");$form_city=$form->element_Textbox("City","city");$form_kecamatan=$form->element_Textbox("Kecamatan","kecamatan");$form_nama_penerima=$form->element_Textbox("Nama Penerima","nama_penerima");$form_status_delivery=$form->element_Textbox("Status Delivery","status_delivery");$form_tanggal_dikirim=$form->element_Textbox("Tanggal dikirim","tanggal_di_kirim");$form_date_report=$form->element_Textbox("Date Report","date_report");$form_price_perkg=$form->element_Textbox("Price Perkg","price_perkg");$form_lead_time=$form->element_Textbox("Lead Time","lead_time");$form_real_time=$form->element_Textbox("Real Time","real_time");$form_remarks=$form->element_Textbox("Remarks","remarks");$form_status=$form->element_Textbox("Status","status");$form_point_code=$form->element_Textbox("Point Code","point_code");/*  <div class="form-group">                    $form_hp                                      </div>                  <div class="form-group">                    $form_alamat                                      </div>		*/		  echo <<<END  <div class="card card-primary">              <div class="card-header">                <h3 class="card-title">$label_action Master Data</h3>              </div>              <!-- /.card-header -->              <!-- form start -->              <form role="form" method="POST" id="form-member"  class="form-member yona-validation" action="$do_action"  novalidate enctype="multipart/form-data">				<input type="hidden" name="id" value="$id" />                <div class="card-body">             					<div class="form-group">					$form_nama                 					</div>					<div class="form-group">					$form_nama_consultan                 					</div>					<div class="form-group">					$form_tanggal_invoice                 					</div>					<div class="form-group">					$form_nomor_invoice                 					</div>					<div class="form-group">					$form_tanggal_dispatch                 					</div>					<div class="form-group">					$form_kurir                 					</div>					<div class="form-group">					$form_nomor_waybill                 					</div>					<div class="form-group">					$form_awb                 					</div>					<div class="form-group">					$form_kode_pos                 					</div>					<div class="form-group">					$form_sales_amount                 					</div>					<div class="form-group">					$form_debt                 					</div>					<div class="form-group">					$form_jenis_kiriman                 					</div>					<div class="form-group">					$form_jml_koli                 					</div>					<div class="form-group">					$form_kg                 					</div>					<div class="form-group">					$form_cek                 					</div>					<div class="form-group">					$form_address                 					</div>					<div class="form-group">					$form_phone                 					</div>					<div class="form-group">					$form_city                 					</div>					<div class="form-group">					$form_kecamatan                 					</div>					<div class="form-group">					$form_nama_penerima                 					</div>					<div class="form-group">					$form_status_delivery                 					</div>					<div class="form-group">					$form_tanggal_dikirim                 					</div>					<div class="form-group">					$form_date_report                 					</div>								<div class="form-group">					$form_price_perkg                 					</div>								<div class="form-group">					$form_lead_time                 					</div>					<div class="form-group">					$form_real_time                 					</div>					<div class="form-group">					$form_remarks                 					</div>					<div class="form-group">					$form_status                 					</div>					<div class="form-group">					$form_point_code                 					</div>				                <div class="card-footer">                   <button type="button" class="btn btn-default" onclick="history.back(-1);">Batal</button>&nbsp;&nbsp;&nbsp;<button type="submit" name="submit" value="1" class="btn btn-primary">Simpan</button>                </div>              </form>            </div>            <!-- /.card -->END;}if($action=="view"){	$q=$mysql->query("SELECT * FROM data_sla WHERE awb='$id'");$d=$mysql->fetch_assoc($q);$qrcode=generateQRCode($d['awb']);extract($d);	echo <<<END<div class="card">		<div class="card-header">		  <h3 class="card-title">$awb</h3>		  		</div>		<!-- /.card-header -->		<div class="card-body">			<img src="$qrcode">			<table>			<tr><td>AWB</td><td>:</td><td>$awb</td></tr>				<tr><td>No Konsultan</td><td>:</td><td>$no_consultan</td></tr>				<tr><td>Nama Konsultan</td><td>:</td><td>$nama_consultan</td></tr>				<tr><td>Nomor Invoice</td><td>:</td><td>$nomor_invoice</td></tr>				<tr><td>Tanggal Invoice</td><td>:</td><td>$tanggal_invoice</td></tr>				<tr><td>Tanggal Dispatch</td><td>:</td><td>$tanggal_dispatch</td></tr>				<tr><td>Nomor Way Bill</td><td>:</td><td>$nomor_waybill</td></tr>				<tr><td>Kode Pos</td><td>:</td><td>$kode_pos</td></tr>				<tr><td>Sales Amount</td><td>:</td><td>$sales_amount</td></tr>				<tr><td>Jenis Kiriman</td><td>:</td><td>$jenis_kiriman</td></tr>				<tr><td>Jumlah Koli</td><td>:</td><td>$jml_koli</td></tr>				<tr><td>KG</td><td>:</td><td>$kg</td></tr>				<tr><td>Alamat</td><td>:</td><td>$address</td></tr>				<tr><td>Telp</td><td>:</td><td>$phone</td></tr>				<tr><td>Kota</td><td>:</td><td>$city</td></tr>				<tr><td>Kecamatan</td><td>:</td><td>$kecamatan</td></tr>				</table>		</div>		<!-- /.card-body -->	  </div></div>END;	}if($action==""){//$btn_tambah=button_add("$modul/add");echo <<<END<div class="card">		<div class="card-header">		  <h3 class="card-title">Master Data</h3>		  		  <div class="float-right">$btn_tambah</div>		</div>		<!-- /.card-header -->		<div class="card-body">				<table id="datalist" class="table table-bordered table-striped responsive no-wrap">				<thead>				<tr>				<th>AWB</th>				<th>Invoice</th>				<th style="width:80px;">Action</th>				</tr>				</thead>				</table>		</div>		<!-- /.card-body -->	  </div></div>END;}if($action=="data") {		$column_order = array('awb','nomor_invoice');	$column_search = array('awb','nomor_invoice');	$order = array('awb' => 'DESC');		if(isset($_POST['order'])) { // here order processing		$order_by = " ORDER BY {$column_order[$_POST['order']['0']['column']]} {$_POST['order']['0']['dir']}";	} else {		$order = $order;				$order_by = " ORDER BY awb DESC ";	}	if ($_POST['length'] != -1 AND $_POST['length']!="") {		$where_limit = "LIMIT {$_POST['start']}, {$_POST['length']}";	}	$i = 0;	$sql_search=array();	foreach ($column_search as $item) { // loop column 				if($_POST['search']['value']) { // if datatable send POST for search						$sql_search[]= " $item LIKE '%{$_POST['search']['value']}%' ";		}		$i++;	}		if(count($sql_search)>0){	$sql_r[]=" ".join(" OR ",$sql_search)." ";	}		$sql=" 	SELECT 		nomor_invoice,awb,id	FROM 		data_sla		WHERE id_cabang=$id_cabang		";			if(count($sql_r)>0){		$sql.=" AND  (".join(" OR ",$sql_r).") ";	}		$result_total = $mysql->query($sql);	$total=$mysql->num_rows($result_total);	$sql .= " $order_by $where_limit";		$result = $mysql->query($sql);		$data = array();			$gotopage = $_POST['start']/$_POST['length'];	$no = $_POST['start'];	while($d = $mysql->fetch_assoc($result)) {				$no++;		$row = array();				$row[]=$d['awb'];		$row[]=$d['nomor_invoice'];		$action_view=btn_general(backendurl("tracking/?awb=".$d['awb']),'fa-truck').btn_eye(backendurl("$modul/view/".$d['awb']));		$action_edit=$daftar_hak[$modul]['edit']==1?btn_edit(backendurl("$modul/edit/".$d['id'])):'';		//$action_delete=$daftar_hak[$modul]['del']==1?btn_delete(backendurl("$modul/del/".$d['id'])):'';		/*		$action_edit='<a href="'.backendurl("$modul/edit/".$d['id']).'"><i class="fas fa-edit" aria-hidden="true"></i></a>&nbsp;&nbsp;&nbsp;&nbsp;';		$action_delete='<a class=""  title="Hapus buku"				data-toggle="modal" 				data-target="#modal-default" 				data-title="Hapus data" 				data-body="Apakah anda yakin ingin menghapus data ini?"				data-btn2=""				data-btn2name=""				data-btn1="'.backendurl("$modul/del/".$d['id']).'"				data-btn1name="Hapus"				>				<i class="fas fa-trash"></i>		</a>';		*/		$row[]='<div class="btn-group btn-group-sm">'.$action_view.$action_edit.$action_delete.'</div>';				$data[] = $row;	}		$output = array(		"draw" => $_POST['draw'],		"recordsTotal" => $total,		"recordsFiltered" => $total,		"data" => $data	);	die(json_encode($output));}?>