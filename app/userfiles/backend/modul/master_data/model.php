<?php/*Catatan pakai yona-validation:Form :	Form menggunakan class yona-validation	Tombol submit name=submitVar  : nama element harus sama dengan var   * */$hari_ini=date("Y-m-d H:i:s");$admin_id=$_SESSION['s_id'];		$validation->set_validation(array('var'=>'awb','label'=>'AWB'))->minlength(1)->required();$validation->generate_js_validation();if($action=="save" or $action=="update") {	$id=$_POST['id'];				if($validation->valid()){		$r_post=array(		'id',		'no_consultan',		'nama_consultan',		'tanggal_invoice',		'nomor_invoice',		'tanggal_dispatch',		'kurir',		'nomor_waybill',		'awb',		'kode_pos',		'sales_amount',		'debt',		'jenis_kiriman',		'jml_koli',		'kg',		'cek',		'address',		'phone',		'city',		'kecamatan',		'nama_penerima',		'status_delivery',		'tanggal_di_kirim',		'tanggal_di_terima',		'date_report',		'price_perkg',		'lead_time',		'real_time',		'remarks',		'status',		'point_code'	);		$sql_r = array();						if($action=="save") {			$sql_r[]="created_by='$admin_id'";			$sql_r[]="created_date='$hari_ini'";			$sql_r[]="id_cabang='$id_cabang'";		}				if($action=="update") {			$sql_r[]="modified_by='$admin_id'";			$sql_r[]="modified_date='$hari_ini'";		}				foreach($r_post as $i => $v) {			if($v=='address' or $v=='remarks') {				$post=cleanInput($_POST[$v],'html');			} else {				$post=cleanInput($_POST[$v]);			}			$sql_r[]="$v = '$post'";		}				if($action=="save") {			$sql=" INSERT INTO data_sla SET ".join(" ,",$sql_r);			$q=$mysql->query($sql);			$last_id=$mysql->insert_id();		}				if($action=="update") {			$sql=" UPDATE data_sla SET ".join(" ,",$sql_r)." WHERE id=$id ";						$q=$mysql->query($sql);		}						} else {		sweetalert2($type="warning",$msg=($action=="update"?"Update":"Tambah")." SLA gagal, data tidak valid",backendurl("$modul".($action=="update"?"/edit/$id":"/add")));	}		if($q){				sweetalert2($type="success",$msg=($action=="update"?"Update":"Tambah")." SLA berhasil",backendurl("$modul"));	} else {		sweetalert2($type="warning",$msg=($action=="update"?"Update":"Tambah")." SLA gagal. ",backendurl("$modul".($action=="update"?"/edit/$id":"/add")));	}	}if($action=="del"){$id=cleanInput($id,'numeric');//update log	$valid=true;	$mysql->autocommit(false);	$sql="DELETE FROM master_tamu WHERE id='$id' AND id_cabang=$id_cabang";	$r=$mysql->query($sql);	if($r and $valid){		$mysql->commit();		$mysql->autocommit(true);		sweetalert2($type="success",$msg="Hapus Item berhasil",backendurl("$modul"));	} else {		$mysql->rollback();			sweetalert2($type="warning",$msg="Hapus Item gagal",backendurl("$modul"));	}	}?>