<?phpif($action=="del"){$r=$mysql->query("SELECT * from quiz_done where id=$id");$d=$mysql->assoc($r);$sql="DELETE FROM quiz_done WHERE id=$id";$r=$mysql->query($sql);if($r){	header("location:".backendurl("$modul/view"));}}if($action=="download_excel"){error_reporting(E_ALL);ini_set('display_errors', TRUE);ini_set('display_startup_errors', TRUE);date_default_timezone_set('Asia/Jakarta');if (PHP_SAPI == 'cli')	die('This example should only be run from a Web Browser');// Create new PHPExcel object$objPHPExcel = new PHPExcel();// Set document properties$objPHPExcel->getProperties()->setCreator("websuka.com")							 ->setLastModifiedBy("websuka.com")							 ->setTitle("Ujian Online SMK ALHIKAM")							 ->setSubject("Ujian Online SMK ALHIKAM")							 ->setDescription("Ujian Online SMK ALHIKAM")							 ->setKeywords("Ujian Online SMK ALHIKAM")							 ->setCategory("Ujian Online SMK ALHIKAM");/////////////////////////////////////////$id=cleanInput($id);	$sql="SELECT d.*,m.username,fullname,class,score FROM quiz_done d LEFT JOIN quiz_member m ON d.member_id=m.id WHERE d.is_done=1 AND DATE_FORMAT(d.start_time,'%Y%m%d')='$id' AND member_class='".$_GET['id_class']."'";$sql.="  order by member_id";$r=$mysql->query($sql);// Add some data$objPHPExcel->setActiveSheetIndex(0)            ->setCellValue('A1',_UJIANMULAI)            ->setCellValue('B1',_KODELOGIN)            ->setCellValue('C1',_NAMALENGKAP)            ->setCellValue('D1',_CLASS)            ->setCellValue('E1',_KODESOAL)            ->setCellValue('F1',_NAMASOAL)            ->setCellValue('G1',_B)            ->setCellValue('H1',_S)            ->setCellValue('I1',_TIDAK_JAWAB)            ->setCellValue('J1',_SCORE);$no=1;$quiz_date=$quiz_code=$quiz_title="";while($d=$mysql->assoc($r)){	$no++;	$objPHPExcel->setActiveSheetIndex(0)            ->setCellValue('A'.$no,$d['start_time'])            ->setCellValue('B'.$no,$d['username'])            ->setCellValue('C'.$no,$d['fullname'])            ->setCellValue('D'.$no,$d['class'])            ->setCellValue('E'.$no,$d['quiz_code'])            ->setCellValue('F'.$no,$d['quiz_title_id'])            ->setCellValue('G'.$no,$d['benar'])            ->setCellValue('H'.$no,$d['salah'])            ->setCellValue('I'.$no,$d['tidak_jawab'])            ->setCellValue('J'.$no,$d['score']);$quiz_code=$d['quiz_code'];$quiz_title=$d['quiz_title_id'];$quiz_date=date("Ymd",strtotime($d['start_time']));}//$filename="{$quiz_date}_{$quiz_code}_{$quiz_title}";$filename="{$quiz_date}_{$quiz_code}_{$quiz_title}";$sheet_title="{$quiz_date}_{$quiz_code}";// Rename worksheet$objPHPExcel->getActiveSheet()->setTitle($sheet_title);// Set active sheet index to the first sheet, so Excel opens this as the first sheet$objPHPExcel->setActiveSheetIndex(0);////////////////////////////////////////// Redirect output to a clientâ€™s web browser (Excel5)header('Content-Type: application/vnd.ms-excel');header('Content-Disposition: attachment;filename="'.$filename.'.xls"');header('Cache-Control: max-age=0');// If you're serving to IE 9, then the following may be neededheader('Cache-Control: max-age=1');// If you're serving to IE over SSL, then the following may be neededheader ('Expires: Mon, 26 Jul 1997 05:00:00 GMT'); // Date in the pastheader ('Last-Modified: '.gmdate('D, d M Y H:i:s').' GMT'); // always modifiedheader ('Cache-Control: cache, must-revalidate'); // HTTP/1.1header ('Pragma: public'); // HTTP/1.0$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5');$objWriter->save('php://output');exit;}?>