<?phpif($_GET['download']=="1" and $_GET['id_sylabus']!='') {$id=$_GET['id_sylabus'];$silabus=get_sylabus($id);$data_silabus= get_sylabus_identity($id);$data_kompentensi = get_master_competency();$nama_sekolah = $data_silabus['nama_sekolah'];$styleTable = array('borderSize' => 6, 'borderColor' => '006699','cellMargin' => 0, 'cellMarginRight' => 0, 'cellMarginBottom' => 3, 'cellMarginLeft' => 3);	$styleTableIdentity = array('borderSize' => 0,'borderColor' => 'FFFFFF','cellMargin' => 0, 'cellMarginRight' => 0, 'cellMarginBottom' => 3, 'cellMarginLeft' => 3);	$styleTitle = array('size' => 11, 'bold' => true,'align'=>'center');	$styleWarning = array('size' => 11, 'bold' => true);	$noSpace = array('spaceAfter' => 0,'spaceBefore' => 0);$section = $phpWord->addSection(array('orientation'=>"landscape",'pageSizeH'=>\PhpOffice\PhpWord\Shared\Converter::inchToTwip(8.47),'pageSizeW'=>\PhpOffice\PhpWord\Shared\Converter::inchToTwip(13)));$section->addText(htmlspecialchars('SILABUS'),$styleTitle);$section->addTextBreak();//Identitas$phpWord->addTableStyle('Fancy Table2', $styleTableIdentity);$phpWord->addTableStyle('Fancy Table', $styleTable);$data_identitas = array('ID_SILABUS' => $data_silabus['id'],'Nama Sekolah' => $nama_sekolah,'Mata Pelajaran' => $data_silabus['lesson'],'Kelas/Semester' => $data_silabus['level'].'/'.$data_silabus['semester'],'Program Studi' => $data_silabus['major'],'Tahun Ajaran' => $data_silabus['year'],'Kompentensi Inti' => '',);$cel21=$section->addTable("Fancy Table2");foreach($data_identitas as $label => $value) {$cel21->addRow();$cel21->addCell(2500)->addText($label,$styleCell1,$noSpace);$cel21->addCell(300)->addText(":",$styleCell1,$noSpace);$cel21->addCell(3000)->addText($value,$styleCell,$noSpace);}//Kompetensi Inti$section->addTextBreak();$cel21=$section->addTable("");foreach($data_kompentensi as $label => $value) {$cel21->addRow();$cel21->addCell(600)->addText($label,$styleCell1,$noSpace);$cel21->addCell(600)->addText(":",$styleCell1,$noSpace);$cel21->addCell(12000)->addText($value,$styleCell,$noSpace);}$section->addTextBreak();$section->addTextBreak();$styleCell = array('valign' => 'top','align' => 'left','spaceAfter' => 0);$styleCell1 = array('valign' => 'top','align' => 'center','size'=>11,'bold'=>true,'shading' => array('fill' => 'EEEEEE'));//Konten Silabus$cel21=$section->addTable($styleTable);$cel21->addRow();$cel21->addCell(6000)->addText("Kompetensi Dasar",$styleCell1,$noSpace);$cel21->addCell(6000)->addText("Indikator Pencapaian",$styleCell1,$noSpace);//$cel21->addCell(12000)->addText("",$styleCell1,$noSpace);$cel21->addCell(3000)->addText("Materi Pokok",$styleCell1,$noSpace);$cel21->addCell(2000)->addText("Alokasi Waktu",$styleCell1,$noSpace);/**/foreach($silabus as $row => $data) {	$cel21->addRow();	//BLOCK COMPETENCY	$inner1=$cel21->addCell(6000);	table_competency($inner1,$data['competency']);	//BLOCK INDICATOR	$inner2=$cel21->addCell(6000);	table_indicator($inner2,$data['indicator']);	$cel21->addCell(3000)->addText($data['subject'],$styleCell,$noSpace);	$cel21->addCell(2000)->addText($data['allocation'],$styleCell,$noSpace);}		$name=$data_silabus['lesson']."-".$data_silabus['level']." ".$data_silabus['major']."-".$data_silabus['semester'];	$filename="SILABUS_".stripslashes($name).'.docx';	// Save file	$targetFile=$config['userdir'].'backend/modul/quiz_upload_wordx/backup/'.$filename;		$phpWord->save($targetFile,"Word2007");		header('Content-Description: File Transfer');	header('Content-Type: application/octet-stream');	header('Content-Disposition: attachment; filename='.$filename.'');	header('Content-Transfer-Encoding: binary');	header('Expires: 0');	header('Cache-Control: must-revalidate, post-check=0, pre-check=0');	header('Pragma: public');	header('Content-Length: ' . filesize($targetFile));	ob_clean();	flush();		$status = readfile($targetFile);	unlink($targetFile);	exit;	}if($action=="download") {$nama_sekolah = $mysql->get1value("SELECT title_id FROM web_config WHERE name='nama_sekolah'");$sql="SELECT 	s.id,	s.name,	s.semester,	s.id_level,	s.id_lesson,	s.id_major,	s.id_teacher,	s.year,	s.competency_rows,	l.name level,	n.name lesson,	m.name major,	u.fullname teacherFROM 	master_sylabus s LEFT JOIN	master_level l ON	s.id_level=l.idLEFT JOIN 	master_lesson n ON s.id_lesson = n.idLEFT JOIN	master_academic_major m ON s.id_major=m.idLEFT JOIN	user u ON s.id_teacher=u.idWHERE s.id=$id";$query_silabus = $mysql->query($sql);$data_silabus = $mysql->assoc($query_silabus);$tingkat=$data_silabus['id_level'];$semester=$data_silabus['semester'];$lesson=$data_silabus['lesson'];$teacher=$data_silabus['teacher'];$year=$data_silabus['year'];$competency_rows=$data_silabus['competency_rows'];$data_kompentensi = $mysql->get_assoc('code','content','master_core_competency'," code asc ") ;$styleTable = array('borderSize' => 6, 'borderColor' => '006699','cellMargin' => 0, 'cellMarginRight' => 0, 'cellMarginBottom' => 3, 'cellMarginLeft' => 3);	$styleTableIdentity = array('borderSize' => 0,'borderColor' => 'FFFFFF','cellMargin' => 0, 'cellMarginRight' => 0, 'cellMarginBottom' => 3, 'cellMarginLeft' => 3);	$styleTitle = array('size' => 11, 'bold' => true,'align'=>'center');	$styleWarning = array('size' => 11, 'bold' => true);	$noSpace = array('spaceAfter' => 0,'spaceBefore' => 0);$section = $phpWord->addSection(array('orientation'=>"landscape",'pageSizeH'=>\PhpOffice\PhpWord\Shared\Converter::inchToTwip(8.47),'pageSizeW'=>\PhpOffice\PhpWord\Shared\Converter::inchToTwip(13)));$section->addText(htmlspecialchars('SILABUS'),$styleTitle);$section->addTextBreak();//Identitas$phpWord->addTableStyle('Fancy Table2', $styleTableIdentity);$phpWord->addTableStyle('Fancy Table', $styleTable);$data_identitas = array('ID_SILABUS' => $data_silabus['id'],'Nama Sekolah' => $nama_sekolah,'Mata Pelajaran' => $data_silabus['lesson'],'Kelas/Semester' => $data_silabus['level'].'/'.$data_silabus['semester'],'Program Studi' => $data_silabus['major'],'Tahun Ajaran' => $data_silabus['year'],'Kompentensi Inti' => '',);$cel21=$section->addTable("Fancy Table2");foreach($data_identitas as $label => $value) {$cel21->addRow();$cel21->addCell(2500)->addText($label,$styleCell1,$noSpace);$cel21->addCell(300)->addText(":",$styleCell1,$noSpace);$cel21->addCell(3000)->addText($value,$styleCell,$noSpace);}//Kompetensi Inti$section->addTextBreak();$phpWord->addTableStyle('Fancy Table2', $styleTable);$cel21=$section->addTable("Fancy Table2");foreach($data_kompentensi as $label => $value) {$cel21->addRow();$cel21->addCell(600)->addText($label,$styleCell1,$noSpace);$cel21->addCell(600)->addText(":",$styleCell1,$noSpace);$cel21->addCell(12000)->addText($value,$styleCell,$noSpace);}$section->addTextBreak();$section->addTextBreak();$styleCell = array('valign' => 'top','align' => 'left','spaceAfter' => 0);$styleCell1 = array('valign' => 'top','align' => 'center','size'=>11,'bold'=>true,'shading' => array('fill' => 'EEEEEE'));//Konten Silabus$cel21=$section->addTable("Fancy Table");$cel21->addRow();$cel21->addCell(6000)->addText("Kompetensi Dasar",$styleCell1,$noSpace);$cel21->addCell(6000)->addText("Indikator Pencapaian",$styleCell1,$noSpace);//$cel21->addCell(12000)->addText("",$styleCell1,$noSpace);$cel21->addCell(3000)->addText("Materi Pokok",$styleCell1,$noSpace);$cel21->addCell(2000)->addText("Alokasi Waktu",$styleCell1,$noSpace);/**/$cel21->addRow();//BLOCK COMPETENCY$inner1=$cel21->addCell(6000);table_competency($inner1,array(),1);//BLOCK INDICATOR$inner2=$cel21->addCell(6000);table_indicator($inner2,array(),1);$cel21->addCell(3000)->addText("",$styleCell,$noSpace);$cel21->addCell(2000)->addText("",$styleCell,$noSpace);for($i=1;$i<$competency_rows;$i++) {$cel21->addRow();$inner1=$cel21->addCell(6000);table_competency($inner1);$inner1=$cel21->addCell(6000);table_indicator($inner1);$cel21->addCell(3000)->addText("",$styleCell,$noSpace);$cel21->addCell(2000)->addText("",$styleCell,$noSpace);}/**/	$name=$data_silabus['lesson']."-".$data_silabus['level']." ".$data_silabus['major']."-".$data_silabus['semester'];	$filename="Template_SILABUS_".$name.'.docx';	// Save file	$targetFile=$config['userdir'].'backend/modul/quiz_upload_wordx/backup/'.$filename;		$phpWord->save($targetFile,"Word2007");		header('Content-Description: File Transfer');	header('Content-Type: application/octet-stream');	header('Content-Disposition: attachment; filename='.$filename.'');	header('Content-Transfer-Encoding: binary');	header('Expires: 0');	header('Cache-Control: must-revalidate, post-check=0, pre-check=0');	header('Pragma: public');	header('Content-Length: ' . filesize($targetFile));	ob_clean();	flush();		$status = readfile($targetFile);	unlink($targetFile);	exit;	}if($action=="form") {$id_sylabus=cleanInput($_GET['id_sylabus']);	list($sylabus) = $mysql->r_assoc("master_sylabus","id_level,id_lesson,id_major,id_teacher","id=".$id_sylabus,$debug=0);$url_upload = backendurl("$modul/uploadwordx?id_sylabus=$id_sylabus");	$url_download_template=backendurl("master_sylabus/download/$id_sylabus");echo <<<END<div class="card">		<div class="card-header">		  <h3 class="card-title">Silabus</h3>		  <div class="float-right"></div>		</div>		<!-- /.card-header -->		<div class="card-body">		 <div class="row">		 <div class="col-md-12">		 <p>1. Silahkan <a href="$url_download_template">download</a> template silabus terlebih dahulu</p>					 <p>2. Silahkan isi template tersebut sesuai panduan video tutorial.</p>		 <p>3. Silahkan upload template soal yang sudah diconvert menjadi zip sesuai video tutorial .</p>		 <form method="post" action="$url_upload" enctype="multipart/form-data">				<p>Pilih template </p>				<input type="hidden" name="form" value="form_silabus"/>				<input type="hidden" name="id_sylabus" value="$id_sylabus"/>				<input type="file"  id="file_wordx" required="required" name="file_wordx" accept="zip/*" class="">				<br/><br/><input type="checkbox" name="timpa" value="1" /> Hapus silabus lama ganti dengan yang baru?				<br/>				<button class="btn btn-primary" type="submit">Upload Template</button>			</form>		 </div>		</div>		</div>		<!-- /.card-body -->	  </div>END;$pratinjau_silabus=show_sylabus($id_sylabus);		echo <<<END<div class="card">		<div class="card-header">		  <h3 class="card-title">Silabus</h3>		  <div class="float-right"></div>		</div>		<!-- /.card-header -->		<div class="card-body">		 <div class="row">		 <div class="col-md-12">			$pratinjau_silabus			<form method="get" action="" enctype="multipart/form-data">			<p>&nbsp;</p>				<input type="hidden" name="id_sylabus" value="$id_sylabus"/>				<button class="btn btn-primary" name="download" value="1" type="submit">Download</button>			</form>		 </div>		</div>		</div>		<!-- /.card-body -->	  </div>END;		}if($action=="add" OR $action=="edit"){	$list_level=$mysql->get_assoc('id','name','master_level','name');	$list_lesson=$mysql->get_assoc('id','name','master_lesson','name');	$list_major=$mysql->get_assoc('id','name','master_academic_major','name');	//$list_competency=$mysql->get_assoc('name','name','master_core_competency','name');if($action=='edit') {		$q=$mysql->query("	SELECT 		id,		name,		semester,		id_level,		id_lesson,		id_major,		id_teacher,		competency_rows,		year	FROM		$modul WHERE id=$id	");	$d=$mysql->assoc($q);		foreach($d as $field => $value) {		$_POST[$field]=$_POST[$field]==''?$value:$_POST[$field];	}}$do_action=backendurl("$modul/".($action=="add"?"save":"update"));$label_action=$action=="add"?"Tambah":"Edit";$form_name=$form->element_Textbox("Judul","name");$form_level= $form->element_Select("Pilih Tingkat","id_level",$list_level );$form_semester= $form->element_Select("Semester","semester",array('1'=>'1','2'=>'2') );$form_lesson= $form->element_Select("Pilih Mata Pelajaran","id_lesson",$list_lesson );$form_major= $form->element_Select("Pilih Bidang Studi","id_major",$list_major );$form_year=$form->element_Textbox("Tahun Ajaran","year");$form_competency_rows=$form->element_Textbox("Jumlah KD","competency_rows");echo <<<END  <div class="card card-navy">              <div class="card-header">                <h3 class="card-title">$label_action $title</h3>              </div>              <!-- /.card-header -->              <!-- form start -->              <form role="form" method="POST" id="form-member"  class="form-member yona-validation" action="$do_action"  novalidate enctype="multipart/form-data">				<input type="hidden" name="id" value="$id" />                <div class="card-body">                   <div class="form-group">                    $form_name                                  </div>                   <div class="form-group">                    $form_level                                  </div>                   <div class="form-group">                    $form_semester                                  </div>                   <div class="form-group">                    $form_lesson                                  </div>                   <div class="form-group">                    $form_major                                  </div>                   <div class="form-group">                    $form_year                                  </div>                                     <div class="form-group">                    $form_competency_rows                                  </div>                                  <div class="card-footer">                   <button type="button" class="btn btn-default" onclick="history.back(-1);">Batal</button>&nbsp;&nbsp;&nbsp;<button type="submit" name="submit" value="1" class="btn btn-primary">Submit</button>                </div>              </form>            </div>            <!-- /.card -->END;}if($action=="view" or $action==""){$btn_tambah=button_add("$modul/add");echo <<<END<div class="card card-navy">		<div class="card-header">		  <h3 class="card-title">$title</h3>		  <div class="float-right">$btn_tambah</div>		</div>		<!-- /.card-header -->		<div class="card-body">				<table id="datalist" class="table table-bordered table-striped responsive no-wrap">				<thead>				<tr>				<th style="width:40px;">No</th>				<th>Judul</th>				<th style="width:80px;">Action</th>				</tr>				</thead>				</table>		</div>		<!-- /.card-body -->	  </div></div>END;}if($action=="data") {		$column_order = array('s.id','s.name');	$column_search = array('s.name');	$order = array('s.id' => 'DESC');		if(isset($_POST['order'])) { // here order processing		$order_by = " ORDER BY {$column_order[$_POST['order']['0']['column']]} {$_POST['order']['0']['dir']}";	} else {		$order = $order;				$order_by = " ORDER BY s.id DESC ";	}	if ($_POST['length'] != -1 AND $_POST['length']!="") {		$where_limit = "LIMIT {$_POST['start']}, {$_POST['length']}";	}	$i = 0;	$sql_search=array();	foreach ($column_search as $item) { // loop column 				if($_POST['search']['value']) { // if datatable send POST for search						$sql_search[]= " $item LIKE '%{$_POST['search']['value']}%' ";		}		$i++;	}		if(count($sql_search)>0){	$sql_r[]=" ".join(" OR ",$sql_search)." ";	}		$sql="SELECT 	s.id,	s.name,	s.semester,	s.id_level,	s.id_lesson,	s.id_major,	s.id_teacher,	s.year,	s.competency_rows,	l.name level,	n.name lesson,	m.name major,	u.fullname teacherFROM 	master_sylabus s LEFT JOIN	master_level l ON	s.id_level=l.idLEFT JOIN 	master_lesson n ON s.id_lesson = n.idLEFT JOIN	master_academic_major m ON s.id_major=m.idLEFT JOIN	user u ON s.id_teacher=u.idWHERE 1=1";	if($_SESSION['s_level']==0){		$sql.=" AND s.created_by=".$_SESSION['s_id'];	}	if(count($sql_r)>0) {		$sql.=" AND  (".join(" OR ",$sql_r).") ";	}		$result_total = $mysql->query($sql);	$total=$mysql->num_rows($result_total);	$sql .= " $order_by $where_limit";		$result = $mysql->query($sql);		$data = array();		$gotopage = $_POST['start']/$_POST['length'];	$no = $_POST['start'];	while($d = $mysql->fetch_assoc($result)) {		$no++;		$row = array();				$row[]=$no;		$info='<br/>'.$d['lesson']." - ".$d['level']." ".$d['major']."/".$d['semester']." ".$d['year'];		$row[]=$d['name'].$info;		$action_add=btn_add(backendurl("$modul/form?id_sylabus=".$d['id']));		$action_edit=btn_edit(backendurl("$modul/edit/".$d['id']));		$action_delete=btn_delete(backendurl("$modul/del/".$d['id']));		/*		$action_edit='<a href="'.backendurl("$modul/edit/".$d['id']).'"><i class="fas fa-edit" aria-hidden="true"></i></a>&nbsp;&nbsp;&nbsp;&nbsp;';		$action_delete='<a class=""  title="Hapus buku"				data-toggle="modal" 				data-target="#modal-default" 				data-title="Hapus data" 				data-body="Apakah anda yakin ingin menghapus data ini?"				data-btn2=""				data-btn2name=""				data-btn1="'.backendurl("$modul/del/".$d['id']).'"				data-btn1name="Hapus"				>				<i class="fas fa-trash"></i>		</a>';		*/		$row[]='<div class="btn-group btn-group-sm">'.$action_view.$action_add.$action_edit.$action_delete.'</div>';				$data[] = $row;	}			$output = array(		"draw" => $_POST['draw'],		"recordsTotal" => $total,		"recordsFiltered" => $total,		"data" => $data	);	die(json_encode($output));}if($action=='view_sylabus') {	$id_sylabus = $id;	$document=$config['userdir'].'backend/modul/'.$modul.'/backup/'.$id_sylabus.'.zip';	$htmlname='';	$zip = new ZipArchive;	$zip->open($document);	for( $i = 0; $i < $zip->numFiles; $i++ ){ 		$stat = $zip->statIndex( $i ); 		$zipfilename = basename($stat['name']);		$ext = pathinfo($zipfilename, PATHINFO_EXTENSION);				if($ext=="htm"){			$htmlname=$zipfilename;		}else{			continue;		}			}	 $index = $zip->locateName("$htmlname");		if ( $index!== false)  {		$xml= new DOMDocument(); 		$xml->preserveWhiteSpace=false;		$xml->formatOutput= true;				$text = $zip->getFromIndex($index);		$xml->loadHTML($text); 				libxml_use_internal_errors(TRUE);		$xpath = new DOMXPath($xml);				/*		$query_path='//td/table';		foreach ($xpath->query($query_path) as $table) {			foreach ($table->childNodes as $row) {				if(!$row->hasChildNodes()) {												continue;				}				$column=$row->childNodes;				$content = $column->item(1);				$isi=$content->childNodes;										foreach ($isi as $cell){							if($cell->tagName=='p') {								$string = $cell->C14N();									var_dump($cell);								echo '<hr/>';							}						}									}			echo '<hr/>';			echo '<hr/>';			echo '<hr/>';		}		*/		$query_path='//body/div/table'; 				$table_section=1;		$silabus=array();		foreach ($xpath->query($query_path) as $table) {							if($table_section==1) {					//identitas					foreach ($table->childNodes as $row) {					if(!$row->hasChildNodes()) {												continue;					}										$column=$row->childNodes;										if($mode_algoritma==1) {						$kolom_kiri=$column->item(0)->nodeValue;						$kolom_kanan=$column->item(4)->nodeValue;						} elseif($mode_algoritma==2) {						$kolom_kiri=$column->item(1)->nodeValue;						$kolom_kanan=$column->item(5)->nodeValue;					}									//	var_dump($kolom_kiri.':'.$kolom_kanan);									}				}				elseif($table_section==2) {					//kompetensi inti				}				elseif($table_section==3) {					//kd					$baris=1;					$selector='';					$skip=true;					foreach ($table->childNodes as $row) {										if(!$row->hasChildNodes()) {												continue;					}					if($skip) { 						$skip=false;						continue;					}																									$column=$row->childNodes;					if($mode_algoritma==1) {						$silabus[$baris]['subject']=strip_tags(upload_wordx_cleaner($column->item(4)->C14N()));						$silabus[$baris]['allocation']=strip_tags(upload_wordx_cleaner($column->item(6)->C14N()));					}					if($mode_algoritma==2) {						$silabus[$baris]['subject']=strip_tags(upload_wordx_cleaner($column->item(5)->C14N()));						$silabus[$baris]['allocation']=strip_tags(upload_wordx_cleaner($column->item(7)->C14N()));					}																									$kolom=1;					foreach ($column as $cell){												if(!$cell->hasChildNodes()) {													continue;						}												//*cari table kompetensi dan table indikator						$table_inner=$cell->childNodes;						foreach ($table_inner as $table_innercell) {							if(!$table_innercell->hasChildNodes()) {														continue;							}							if($table_innercell->tagName=='table') {								//tabel kompetensi dan indikator ketemu namun perlu lebih dalam lagi selectornya								$inner_table=$table_innercell->childNodes;								foreach ($inner_table as $sub_inner_table){									if(!$sub_inner_table->hasChildNodes()) {																continue;									}																		//select kolom didalamnya									$select_inner=$sub_inner_table->childNodes;																		if($mode_algoritma==1) {										$kode=$select_inner->item(0);										$kompetensi=$select_inner->item(2);									}									if($mode_algoritma==2) {										$kode=$select_inner->item(1);										$kompetensi=$select_inner->item(3);									}																										//$kode_indikator=$select_inner->item(9);																	if(!$kode->hasChildNodes() and !$kompetensi->hasChildNodes()) {																	continue;									} else {										$t_kode=strip_tags(upload_wordx_cleaner($kode->nodeValue));										$t_content=strip_tags(upload_wordx_cleaner($kompetensi->nodeValue));																			if($selector=='') {											$selector='competency';										}																					if(strip_tags(upload_wordx_cleaner($kompetensi->nodeValue))=='Indikator' or strip_tags(upload_wordx_cleaner($kompetensi->nodeValue))=='Kompetensi Dasar') {											$selector=strip_tags(upload_wordx_cleaner($kompetensi->nodeValue))=='Indikator'?'indicator':'competency';										}																				if($t_kode=='Kode' AND ($t_content=='Kompetensi Dasar' or $t_content=='Indikator')) {											continue;										}																														$silabus[$baris][$selector][]=array('code'=>upload_wordx_cleaner($kode->nodeValue),'content'=>upload_wordx_cleaner($kompetensi->nodeValue));																			}									}							}						}						//end cari table kompetensi dan table indikator*/												//var_dump($cell);						/*						echo 'Kolom '.$kolom;						$string = $cell->C14N();							var_dump($string);						*/ 						$kolom++;												}														//$kompetensi_dasar=$column->item(1)->nodeValue;					//$indikator_pencapaian==$column->item(3)->nodeValue;						//$alokasi==$column->item(7)->nodeValue;					//$materi_pokok==$column->item(5)->nodeValue;					//$silabus[$baris]['subject'][]=array('content'=>$column->item(3)->C14N());					//$silabus[$baris]['allocation'][]=array('content'=>$column->item(7)->C14N());														if($baris>1 and false) {						foreach ($column->item(7)->childNodes as $row1) {														if($row1->tagName=='table') 							{																foreach ($row1->childNodes as $row3) {								if(!$row->hasChildNodes()) {															continue;								}																								foreach($row3 as $x) {								//	var_dump($x->nodeValue);									echo '<hr/>';								}																																}								/*								foreach ($row1 as $cell){									$string = $cell->C14N();										var_dump($string);									echo '<hr/>';								}								*/ 								//var_dump($row1->childNodes->item(1)->childNodes->item(1)->nodeValue);								//var_dump($row1->childNodes->item(1)->childNodes->item(3)->nodeValue);								echo '<hr/>';								echo '<hr/>';								echo '<hr/>';															}							//$column1=$row1->childNodes;							//var_dump($column1->item(1)->nodeValue);												}										}					$baris++;										}				}									$table_section++;		}$pratinjau_silabus=show_sylabus($id);		echo <<<END<div class="card">		<div class="card-header">		  <h3 class="card-title">Pratinjau Silabus</h3>		  <div class="float-right"></div>		</div>		<!-- /.card-header -->		<div class="card-body">		 <div class="row">		 <div class="col-md-12">			$pratinjau_silabus			<form method="get" action="" enctype="multipart/form-data">			<p>&nbsp;</p>				<button class="btn btn-primary" name="save_sylabus" value="1" type="submit">Simpan</button>			</form>		 </div>		</div>		</div>		<!-- /.card-body -->	  </div>END;						if($_GET['save_sylabus'] and count($silabus)>0) {			$reset_silabus=$mysql->query("DELETE FROM sylabus_detail WHERE id_master_sylabus=$id");			foreach($silabus as $baris => $data) {								$insert_detail  = $mysql->query("					INSERT INTO sylabus_detail SET						row='".$baris."',						id_master_sylabus='".$id."',						subject='".$data['subject']."',						allocation='".$data['allocation']."'				");				$sylabus_detail_id=$mysql->insert_id();							if(count($data['competency'])>0) {					foreach($data['competency'] as $x => $dk) {						$insert_competency  = $mysql->query("						INSERT INTO sylabus_detail_competency SET							id_sylabus_detail='".$sylabus_detail_id."',							code='".$dk['code']."',							content='".$dk['content']."'						");					}				}				if(count($data['indicator'])>0) {					foreach($data['indicator'] as $x => $di) {						$insert_indikator  = $mysql->query("						INSERT INTO sylabus_detail_indicator SET							id_sylabus_detail='".$sylabus_detail_id."',							code='".$di['code']."',							content='".$di['content']."'						");					}									}												 			}						sweetalert2($type="success",$msg="Berhasil upload silabus",backendurl("$modul"));		}			} else {		die('Tidak ada html');	}}?>