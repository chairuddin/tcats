<?phpif($action=="edit"){$r=$mysql->query("SELECT * from $modul where id=$id");$d=$mysql->assoc($r);$form = new Form("update{$modul}");$form->configure(array(	"prevent" => array("bootstrap", "jQuery", "focus"),	"action" =>backendurl("$modul/update"),	"enctype" =>"multipart/form-data" ));$form->addElement(new Element_HTML('<legend>'._MODULEDIT.'</legend>'));if(file_exists("$small_pic/".$d['thumbnail']) and $d['thumbnail']!=''){$thumbimage="$small_url/".$d['thumbnail'];$form->addElement(new Element_HTML('<div><img src="'.$thumbimage.'" /><br><br></div>'));}$q=$mysql->query("SELECT id,name_$lang title FROM news_category order by urutan,name_$lang");$option=array();$option["-1"]=_PILIH;if($q and $mysql->numrows($q)>0){	while($s=$mysql->assoc($q))	{		$option[$s['id']]=$s['title'];	}}$form->addElement(new Element_Select(_CATEGORY, "cat_id", $option,array("value"=>$d['cat_id']))); $form->addElement(new Element_Hidden("form", "update{$modul}"));$form->addElement(new Element_Hidden("id", "$id"));$form->addElement(new Element_File(_THUMBNAIL, "filename"));foreach($list_lang as $i =>$v){$form->addElement(new Element_Textbox(_JUDUL." ($v)","title_$v",array("value"=>$d["title_$v"])));}foreach($list_lang as $i =>$v){$form->addElement(new Element_TinyMCE(_KETSINGKAT." ($v)","summary_$v",array("value"=>$d["summary_$v"])));}foreach($list_lang as $i =>$v){$form->addElement(new Element_TinyMCE(_KONTENT." ($v)","content_$v",array("value"=>$d["content_$v"])));}list($yy,$mm,$dd)=explode("-",$d["tanggal"]);$d["tanggal"]="$dd/$mm/$yy";$form->addElement(new Element_jQueryUIDate("Publish date", "tanggal",array("value"=>$d["tanggal"],"jQueryOptions" => array("dateFormat" => "dd/mm/yy"))));//$form->addElement(new Element_Textbox(_JUDUL,"title_id", array("required" => 1,"value"=>$d['title_id'])));//$form->addElement(new Element_Textarea(_KONTENT,"content_id", array("required" => 1,"value"=>$d['content_id'])));//$form->addElement(new Element_Textbox(_URL,"url", array("required" => 1,"value"=>$d['url'])));$form->addElement(new Element_Button(_SIMPAN));$form->addElement(new Element_Button(_BATAL, "button", array(	"onclick" => "history.go(-1);")));$form->render();}if($action=="add"){$form = new Form("{$modul}add");$form->configure(array(	"prevent" => array("bootstrap", "jQuery", "focus"),	"action" =>backendurl("$modul/save"),	"enctype" =>"multipart/form-data" ));	$form->addElement(new Element_HTML('<legend>'._MODULTAMBAH.'</legend>'));$form->addElement(new Element_Hidden("form", "{$modul}add"));$form->addElement(new Element_File(_THUMBNAIL, "filename"));$q=$mysql->query("SELECT id,name_$lang title FROM news_category order by urutan,name_$lang");$option=array();$option["-1"]=_PILIH;if($q and $mysql->numrows($q)>0){	while($s=$mysql->assoc($q))	{		$option[$s['id']]=$s['title'];	}}$form->addElement(new Element_Select(_CATEGORY, "cat_id", $option)); foreach($list_lang as $i =>$v){$form->addElement(new Element_Textbox(_JUDUL." ($v)","title_$v"));}foreach($list_lang as $i =>$v){$form->addElement(new Element_TinyMCE(_KETSINGKAT." ($v)","summary_$v"));}foreach($list_lang as $i =>$v){$form->addElement(new Element_TinyMCE(_KONTENT." ($v)","content_$v"));}$form->addElement(new Element_jQueryUIDate("Publish date", "tanggal",array("value"=>date("d/m/Y"),"jQueryOptions" => array("dateFormat" => "dd/mm/yy"))));$form->addElement(new Element_Button(_SIMPAN));$form->addElement(new Element_Button(_BATAL, "button", array(	"onclick" => "history.go(-1);")));$form->render();}if($action=="" or $action=="search" or $action=="view"){$form_search=form_search($keyword);}if($action=="view" or $action=="" or $action=="search"){$US=new UpdateStatus("$modul","publish",".setpublish");$col_tambah=button_add("$modul/add");$sql="SELECT n.*,c.name_$lang FROM $modul n left join news_category c on n.cat_id=c.id ";if($action=="search"){$sql.=" WHERE ";$sql.=" n.title_$lang LIKE '%$keyword%' ";}/*echo "<script>$(document).ready(function(){$('#news_row').sortable({update: function(event, ui){sort=$('#news_row').sortable('serialize'); $.ajax({ 		type: 'POST',        url:'".backendurl("$modul/sortitem")."',        data:sort,        success: function(html)        {	//	alert(html);        }        });}});});</script>";*/$r=$mysql->query($sql);$total_records = $mysql->numrows($r);$start = $screen * $max_page_list;$pages = ceil($total_records/$max_page_list);if ($pages>1) $col_pagination=pagination($screen);$sql.="  order by $sort_by $sort_order  LIMIT $start, $max_page_list";$r=$mysql->query($sql);echo "<table id='DataTables_Table_3_wrapper' class='table table-hover table-nomargin table-bordered table-format'>";echo "<thead><tr><!--<th></th>--><th>No</th><th>"._THUMBNAIL."</th>";echo "<th>".orderBy("n.title_$lang",_JUDUL,$sort_order,$sort_by)."</th>";echo "<th>".orderBy("c.name_$lang",_CATEGORY,$sort_order,$sort_by)."</th>";echo "<th>".orderBy("n.tanggal",_TANGGAL,$sort_order,$sort_by)."</th>";echo "<th>".orderBy("publish",_SHOW,$sort_order,$sort_by)."</th>";echo "<th>Action</th></tr></thead>";$no=($start+1);if($mysql->numrows($r)>0){echo '<tbody id="news_row" class="ui-sortable">';while($d=$mysql->assoc($r)){echo "<tr id='list_{$d['id']}'><!--<td><span class='show_row_move'><i class='glyphicon-move'></i></span></td> --><td>$no</td>";$thumbnail_url="$small_url/".$d['thumbnail'];$thumbnail_path="$small_pic/".$d['thumbnail'];if(file_exists("$thumbnail_path")){echo "<td><img style='max-height:100px' src='".$thumbnail_url."'/></td>";}else{echo "<td>&nbsp;</td>";}echo "<td><a href='#' data-pk='".$d['id']."'  data-name='title_$lang' class='nama-news'>".$d["title_$lang"]."</a></td>";echo "<td>".$d["name_$lang"]."</td>";$d["tanggal"]=date("d/m/Y",strtotime($d["tanggal"]));echo "<td>".$d["tanggal"]."</td>";$ar_action=array("edit"=>$d['id'],"del"=>$d['id']);$checked=$d['publish']==1?"checked":"";echo "<td><input class='setpublish' type='checkbox' data-id='".$d['id']."' name='publish' $checked value='1' ></td><td>".button_action($ar_action)."</td></tr>";$no++;}echo '</body>';echo "</tbody>";}echo "</table>";}?>