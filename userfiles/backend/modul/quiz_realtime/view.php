<?php$id=$_GET['schedule_id'];if($action=="" or $action=="search" or $action=="view"){//$form_search=form_search($keyword);}$form_search=form_search($keyword,"?filter=".$_GET['filter']."&schedule_id=$id");if($_GET['filter']=="belum_ujian" OR $_GET['filter']=="sudah_ujian"){$form_title=$action=="belum_ujian"?"Belum Ujian":$form_title;$form_title=$action=="sudah_ujian"?"Sudah Ujian":$form_title;$r_quiz_info=$mysql->query("SELECT quiz_info,token FROM quiz_schedule WHERE id=$id")->fetch_assoc();$quiz_info=json_decode($r_quiz_info['quiz_info'],true);$token=$r_quiz_info['token'];$join_class=$mysql->get1value("SELECT allow_class FROM quiz_schedule WHERE id=$id");$join_class=explode(",",$join_class);$join_class="'".join("','",$join_class)."'";if($_GET['filter']=="belum_ujian"){$sql="SELECT m.* FROM quiz_member mWHERE m.id NOT IN(SELECT member_id FROM quiz_done WHERE schedule_id=".$id." AND member_class IN ($join_class)) AND class IN ($join_class) ";$form_title="Belum Ujian";}if($_GET['filter']=="sudah_ujian"){$sql="SELECT d.*,m.username,fullname,class FROM quiz_done d LEFT JOIN quiz_member m ON d.member_id=m.id WHERE schedule_id=$id AND d.is_done=1 ";$form_title="Sudah Ujian";}if($action=="search"){$sql.=" AND (m.username LIKE '%".$keyword."%' OR m.fullname LIKE '%".$keyword."%' OR m.class LIKE '%".$keyword."%' )";}if($is_wali_kelas){	if(count($config_wali_kelas)>0) {		foreach($config_wali_kelas as $kelas) {			$sql_r[]=" FIND_IN_SET('$kelas',class) ";		}		}}if(count($sql_r)>0) {	$kondisi.=" AND (".join(" or ",$sql_r).")";}$sql.=" $kondisi  order by $sort_by $sort_order";$r=$mysql->query($sql);ob_start();	echo "<table id='belum-ujian' class='table table-bordered table-striped'>";	echo "	<thead>	<tr>	<th>No</th>	<th>"._KODELOGIN."</th>	<th>"._NAMALENGKAP."</th>	<th>"._CLASS."</th>	";	echo "</tr></thead>";	$no=(1);	echo '<tbody>';	while($d=$mysql->assoc($r))	{		echo "		<tr>		<td>$no</td>		<td>".$d['username']."</td>		<td>".$d['fullname']."</td>		<td>".$d['class']."</td>";		$no++;		echo "</tr>";	}	echo "</tbody>";	echo "</table>";$table_data_belum_ujian=ob_get_clean();echo <<<END<div class="card">	<div class="card-header">	  <h3 class="card-title">Belum Ujian</h3>	</div>	<!-- /.card-header -->	<div class="card-body">		<table>			<tr><td>Token</td><td>:</td><td>$token</td></tr>			<tr><td>Kode Soal</td><td>:</td><td>$quiz_info[code]</td></tr>			<tr><td>Nama Soal</td><td>:</td><td>$quiz_info[title_id]</td></tr>			<tr><td>Durasi</td><td>:</td><td>$quiz_info[duration] Menit</td></tr>		</table>		<hr/>		$table_data_belum_ujian	</div>	<!-- /.card-body --></div>END;}$script_js.=<<<END<script>$(function () {    	$('#belum-ujian').DataTable({			'searching'   : true,			'ordering'    : true,			'responsive'  : true,			'processing'  : true,		});		});</script>END;?>