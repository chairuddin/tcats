<?phpif($action=="save"){$sql = "SELECT type,basename, extension, maxdimension, maxfilesize,usecaption,caption FROM slide_show  ORDER BY id";			$result = $mysql->query($sql);			while (list($type,$basename, $oldextension, $maxdimension, $maxfilesize,$usecaption,$caption) = $mysql->row($result)) 			{							if ($_FILES[$basename]['error']!=UPLOAD_ERR_NO_FILE) 				{	//jika kolom file diisi					$hasilupload = upload($basename,"$large_path",$basename,$maxfilesize,"ico,jpg,jpeg,gif,png");					if ($hasilupload!="")redirecto($hasilupload,"error");										//ambil informasi extension					$temp = explode(".",$_FILES[$basename]['name']);					$extension = $temp[count($temp)-1];					//resize gambar asli sesuai yang diizinkan					list($aturan,$maxwidth,$maxheight) = explode(';',$maxdimension);					switch ($aturan) {						case 'fixed':							$hasilresize = resize("$large_path/$basename.$extension","$large_path/$basename.$extension",'f',$maxwidth,$maxheight);							if ($hasilresize!="")redirecto($hasilresize,"error");							break;						case 'max':							list($filewidth,$fileheight,$filetype,$fileattr) = getimagesize("$large_path/$basename.$extension");							if ($filewidth>$maxwidth || $fileheight>$maxheight) 							{								$hasilresize = resize("$large_path/$basename.$extension","$large_path/$basename.$extension",'b',$maxwidth,$maxheight);								if ($hasilresize!="")redirecto($hasilresize,"error");							}							break;										}					$buat_thumbnail = resize("$large_path/$basename.$extension","$large_path/{$basename}_200.$extension",'l',200);					$buat_thumbnail = resize("$large_path/$basename.$extension","$large_path/{$basename}_300.$extension",'l',300);										if ($extension != $oldextension) 					{						unlink("$large_path/$basename.$oldextension");						unlink("$large_path/{$basename}_200.$oldextension");						unlink("$large_path/{$basename}_300.$oldextension");					}					$mysql->query("UPDATE slide_show SET extension='$extension' WHERE basename='$basename'");									}				$v_caption="";				if($usecaption)				{				$r_caption=array();				foreach($list_lang as $i =>$v)				{				$r_caption["title_$v"]=cleanInput($_POST["{$basename}_title_$v"]);				$r_caption["content_$v"]=cleanInput($_POST["{$basename}_content_$v"]);				}				$v_caption=json_encode($r_caption);				}				if($v_caption!="")				$mysql->query("UPDATE slide_show SET caption='$v_caption' WHERE basename='$basename'");			}	redirecto("Berhasil","success","main");		}?>